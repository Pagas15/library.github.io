const CONSTS={api:{arbi:"https://home.scaletrk.com/signup/affiliate",autor:"https://home.scaletrk.com/signup/advertiser"}},header=()=>{const e=document.querySelector(".header");if(e){e.querySelector(".header__btn").addEventListener("click",(t=>{t.preventDefault(),e.classList.contains("active")?(e.classList.remove("active"),document.body.style.overflow="auto"):(e.classList.add("active"),document.body.style.overflow="hidden")}))}},sliders=()=>{const e=e=>{const t=document.querySelector(e);if(t){const e=t.querySelector(".swiperWrapper"),a=t.querySelectorAll(".swiperSlide");e.classList.add("swiper-wrapper"),e.classList.remove("swiperWrapper"),a.forEach((e=>{e.classList.add("swiper-slide"),e.classList.remove("swiperSlide")}))}};if(window.innerWidth<767){e(".swiper1"),e(".swiper2"),e(".swiper3");new Swiper(".swiper1",{loop:!0,slidesPerView:"auto",centeredSlides:!0,spaceBetween:30,autoplay:{delay:5e3},pagination:{el:".swiper-pagination1",clickable:!0,renderBullet:function(e,t){return'<span class="'+t+'"></span>'}}}),new Swiper(".swiper2",{loop:!0,slidesPerView:"auto",centeredSlides:!0,spaceBetween:30,autoplay:{delay:5e3},pagination:{el:".swiper-pagination2",clickable:!0,renderBullet:function(e,t){return'<span class="'+t+'"></span>'}}}),new Swiper(".swiper3",{loop:!0,slidesPerView:"auto",centeredSlides:!0,spaceBetween:30,autoplay:{delay:5e3},pagination:{el:".swiper-pagination3",clickable:!0,renderBullet:function(e,t){return'<span class="'+t+'"></span>'}}})}},modal=()=>{const e=document.querySelector("[data-modal-wrapper]");if(e){const t=document.querySelectorAll("[data-modal-btn-open]"),a=document.querySelectorAll("[data-modal-btn-close]"),n=e.querySelectorAll("[data-modal-window]"),s={};n.forEach((e=>{s[e.dataset.modalWindow]=e}));let l=null;const o=()=>{document.body.style.overflow="auto";for(let e in s)s[e].classList.remove("active")},r=()=>{e.classList.remove("active"),l=null,o()},i=t=>{null===l?(l=t,s[t].classList.add("active"),e.classList.add("active"),document.body.style.overflow="hidden"):l!==t?(o(),l=t,s[t].classList.add("active"),document.body.style.overflow="hidden"):l===t&&r()};return t.forEach((e=>{const t=e.dataset.modalBtnOpen;e.addEventListener("click",(e=>{i(t)}))})),a.forEach((e=>{e.addEventListener("click",r)})),e.addEventListener("click",(t=>{t.target===e&&r()})),{closeOllModal:o,closeModal:r,openModal:i}}},request=async({url:e,method:t="GET",data:a=null,callBack:n})=>{try{const s={};let l;a&&(s["Content-Type"]="application/json",l=JSON.stringify(a));const o=await fetch(e,{method:t,headers:s,body:l});console.log(e,{method:t,headers:s,body:l});const r=await o.json();if(!n)return r;n(r)}catch(e){console.warn("Error: ",e.message)}},inputsAndForms=e=>{const t=/^[^ ]+@[^ ]+\.[a-z]{2,3}$/,a=/^[A-Za-z0-9_-].{8,}$/,n=/^[A-Za-z0-9_-]{3,16}$/,s=(e="Please Enter Valid")=>{let t=document.createElement("p");return t.className="txt25x29 cRed textError",t.innerHTML=e,t},l=(e,t,a)=>{const n=!!e.lastChild?.classList?.contains("textError");t?n&&e.removeChild(e.lastChild):n||e.appendChild(a)},o={name:(e,t=!1)=>{const a=e.closest(".inputBox"),n=s("Как минимум 2 символов"),o=()=>l(a,e.value.length>=2,n);if(!t)return o(),e.value.length>=2;e.addEventListener("input",o)},email:(e,a=!1)=>{const n=e.closest(".inputBox"),o=s("Укажите валидную электронную почту"),r=()=>l(n,!!e.value.match(t),o);if(!a)return r(),!!e.value.match(t);e.addEventListener("input",r)},telegram:(e,t=!1)=>{const a=e.closest(".inputBox"),o=s("Пожалуйста укажите правильный логин"),r=()=>l(a,!!e.value.match(n),o);if(!t)return r(),!!e.value.match(n);e.addEventListener("input",r)},password:(e,t=!1)=>{const n=e.closest(".inputBox"),o=s("Минимум 8 символов, латиницей"),r=()=>l(n,!!e.value.match(a),o);if(!t)return r(),!!e.value.match(a);e.addEventListener("input",r)},passwordRepeat:(e,t=!1)=>{const a=e.closest(".inputBox"),n=s("Пароли должны совпадать"),o=document.querySelector(`[data-main-pass="${e.dataset.repeatPass}"]`),r=()=>l(a,o.value===e.value,n);if(!t)return r(),o.value===e.value;e.addEventListener("input",r)},text:()=>!0};document.querySelectorAll("input").forEach((e=>{const t=e.name;o[t](e,!0)})),(e=>{const t=t=>{"success"===t?.status?e.openModal("successfully"):e.openModal("error")};(()=>{const e=document.querySelector('[data-form-btn="arbit1"]'),a=document.querySelectorAll('[data-form-input="arbit1"]');e.addEventListener("click",(()=>{let e=[];if(a.forEach((t=>{e.push({key:t.name,value:t.value,isValid:o[t.name](t)})})),e.every((e=>!0===e.isValid))){const a={email:e.find((e=>"email"===e.key)).value,firstname:e.find((e=>"name"===e.key)).value,password:e.find((e=>"password"===e.key)).value,password_repeat:e.find((e=>"passwordRepeat"===e.key)).value,contacts:[{type:5,account:e.find((e=>"telegram"===e.key)).value,title:"Telegram"}]};request({url:CONSTS.api.arbi,method:"POST",data:a,callBack:e=>{console.log(e),t(e)}})}}))})(),(()=>{const a=document.querySelector('[data-form-btn="autor1"]'),n=document.querySelector('[data-form-btn-pre="autor1"]'),s=document.querySelectorAll('[data-form-input="autor1"]'),l=(e,t=(()=>{}))=>{let a=[];s.forEach((e=>{a.push({key:e.name,value:e.value,isValid:o[e.name](e)})})),a.every((e=>!0===e.isValid))?e(a):t()};n.addEventListener("click",(()=>{l((()=>{e.openModal("autor2")}))})),a.addEventListener("click",(()=>{l((e=>{const a={email:e.find((e=>"email"===e.key)).value,firstname:e.find((e=>"name"===e.key)).value,password:e.find((e=>"password"===e.key)).value,password_repeat:e.find((e=>"passwordRepeat"===e.key)).value,contacts:[{type:5,account:e.find((e=>"telegram"===e.key)).value,title:"Telegram"}],notes:e.find((e=>"text"===e.key)).value};request({url:CONSTS.api.autor,method:"POST",data:a,callBack:e=>{t(e)}})}),(()=>{e.openModal("autor1")}))}))})()})(e)},init=()=>{const e=modal();header(),sliders(),inputsAndForms(e)};window.addEventListener("DOMContentLoaded",init);