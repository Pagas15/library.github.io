// Was made by Pagas15
// My site - https://pagas15.github.io

const sliers = () => {
	let wsw = window.innerWidth;
	let wsd, ttr;
	if(wsw >= 1600){
		wsd = 4;
	} else if (wsw <= 1600 && wsw >= 1200) {
		wsd = 3;
	} else if (wsw <= 1200 && wsw >= 576) {
		wsd = 2;
	} else if (wsw <= 576) {
		wsd = 1;
	}
	if(wsw >= 992){
		ttr = 3;
	} else if (wsw <= 992 && wsw >= 576) {
		ttr = 2;
	} else if (wsw <= 576) {
		ttr = 1;
	}

	let advantagesSwiper = new Swiper('.advantages-slider', {
		autoplay: {
			delay: 5000,
		},
		direction: 'horizontal',
		slidesPerView: ttr,
		spaceBetween: 0,
		pagination: {
			el: '.swiper-pagination',
			clickable: true,
		},
		navigation: {
			nextEl: '.swiper-button-next',
			prevEl: '.swiper-button-prev',
		},
		loop: true,
	});
	let sliderStatic = new Swiper('.slider-static__slider', {
		autoplay: {
			delay: 4000,
		},
		direction: 'horizontal',
		slidesPerView: wsd,
		spaceBetween: 0,
		loop: true,
	});
};

const accordion = (elemList, elemItem, elemBtn) => {
	if(document.querySelector(elemList)){
		let listItem = document.querySelectorAll(elemItem);
		document.querySelector(elemList).addEventListener('click',e=>{
			e.preventDefault();
			let elem = e.target;
			if(elem.closest(elemBtn)){
				let elemPar = elem.closest(elemItem);
				if(elemPar.classList.contains('active')){
					listItem.forEach(item=>{
						item.classList.remove('active')
					})
				} else {
					listItem.forEach(item=>{
						item.classList.remove('active')
					})
					elemPar.classList.add('active')
				}
			}
		})
	}
}

const clickBel = (elemBtn, elemItem, classElem, btnTr = false) => {
	if(document.querySelector(elemBtn)){
		let btnElem = document.querySelector(elemBtn),
				itemElem = document.querySelector(elemItem),
				bgs = document.querySelector('.header__bg-close');
		btnElem.addEventListener('click', e=>{
			e.preventDefault();
			itemElem.classList.toggle('active');
			bgs.classList.toggle('active')
			if(btnTr){
				btnElem.classList.toggle('active');
			}
		})
		itemElem.addEventListener('click', e=>{
			e.preventDefault();
			if(e.target.classList.contains(classElem)){
				itemElem.classList.remove('active');
				bgs.classList.remove('active')
				if(btnTr){
					btnElem.classList.remove('active');
				}
			};
		});
		bgs.addEventListener('click', e=>{
			e.preventDefault();
			itemElem.classList.remove('active');
			bgs.classList.remove('active');
		})
	}
};

const selecter = () => {
	document.querySelectorAll('.select').forEach(item=>{
		item.addEventListener('click',e=>{
			let elem = e.target;
			if(elem.closest('.select__btns') || elem.closest('.select::before')){
				item.classList.toggle('active');
			}
			if (elem.closest('.select__btn')) {
				let sad = elem.closest('.select__btn');
				let ipt = item.querySelector('.select__btns')
				item.querySelectorAll('.select__btn').forEach(eft=>{
					eft.classList.remove('active');
				});
				sad.classList.add('active');
				item.classList.remove('active');
				ipt.innerHTML = sad.innerHTML;
				ipt.dataset.value = sad.dataset.name;
			}
		})
	})
}
const tabs = (elemWrap,elemBtn,elemTab,nons=false,btnWrap) => {
	if(!nons){
		document.querySelectorAll(elemWrap).forEach(item=>{
			item.addEventListener('click',e=>{
				if((e.target.classList.contains(elemBtn)) && !(e.target.classList.contains('active'))){
					item.querySelectorAll(`.${elemBtn}`).forEach(itesa=>{itesa.classList.remove('active')});
					e.target.classList.add('active')
					item.querySelectorAll(elemTab).forEach(itesa=>{itesa.classList.remove('active')});
					item.querySelector(`[data-idTab="${e.target.dataset.id}"]`).classList.add('active')
				}
			})
		})
	} else {
		let elemWrapAS = document.querySelector(elemWrap);
		document.querySelectorAll(btnWrap).forEach(item=>{
			item.addEventListener('click', e=>{
				if((e.target.classList.contains(elemBtn)) && !(e.target.classList.contains('active'))){
					item.querySelectorAll(`.${elemBtn}`).forEach(itesa=>{itesa.classList.remove('active')});
					e.target.classList.add('active')
					elemWrapAS.querySelectorAll(elemTab).forEach(itesa=>{
						if(itesa.classList.contains('active')){
							if('animate' in itesa){
								let getHeight = itesa.offsetHeight;
								let animate = itesa.animate([
									{ height: `${getHeight}px`, opacity: 1}, 
									{ height: '0px', opacity: 0 }
								], 
									{ duration: 600 }
								);

								animate.addEventListener('finish', function(){
									itesa.classList.remove('active');
								});
							}
							else{
								itesa.classList.remove('active')
							}
						}
					});



					let elemAddAct = elemWrapAS.querySelector(`[data-idTab="${e.target.dataset.id}"]`)
					elemAddAct.classList.add('active')
					let getHeight = elemAddAct.offsetHeight;
					let animate = elemAddAct.animate([
						{ display: 'block', height: '0px', opacity: 0 }, 
						{ height: `${getHeight}px`, opacity: 1 }
					], 
						{ duration: 600 }
					);
				}
			})
		})
	}
}

const header = () => {
	const addHeaderAdapt = () => {
		if(window.innerWidth <= 1200 && window.innerWidth > 720){
			clickBel('#nav-btn', "#nav-bar", 'nav-bar__btn', true);
		}
		if(window.innerWidth <= 720){
			let btnElem = document.querySelector('#nav-btn'),
					itemElem = document.querySelector('#header__nav-bares'),
					bgs = document.querySelector('.header__bg-close');
			btnElem.addEventListener('click', e=>{
				e.preventDefault();
				itemElem.classList.toggle('active');
				btnElem.classList.toggle('active');
				bgs.classList.toggle('active');
			})
			itemElem.addEventListener('click', e=>{
				e.preventDefault();
				if(!(e.target.dataset.how)){
					itemElem.classList.remove('active');
					btnElem.classList.remove('active');
					bgs.classList.remove('active')
				}
			});
			bgs.addEventListener('click', e=>{
				e.preventDefault();
				itemElem.classList.remove('active');
				btnElem.classList.remove('active');
				bgs.classList.remove('active');
			})
		}
	}
	addHeaderAdapt();
}

const passHide = () => {
	document.querySelectorAll('.inputBox--row-i .icon-sr-eye').forEach(item=>{
		let parBtn = item.closest('.inputBox--row-i');
		let inp = parBtn.querySelector('input');
		item.addEventListener('click', ()=>{
			if(inp.type === 'password'){
				inp.type = 'text';
			} else {
				inp.type = 'password';
			}
		})
	})
}

const copyToClipboard = str => {
  const el = document.createElement('textarea');
  el.value = str;
  document.body.appendChild(el);
  el.select();
  document.execCommand('copy');
  document.body.removeChild(el);
};

const copyForew = (btnElem, whatElem) => {
	if(document.querySelector(btnElem)){
		document.querySelector(btnElem).addEventListener('click', ()=>{
			var copyText = document.querySelector(whatElem).innerHTML;
			copyToClipboard(copyText);
			alert("Успешно скопировано");
		})
	}
}

const copyText = () => {
	if(document.querySelector('.btn-txt-copy')){
		document.querySelectorAll('.btn-txt-copy').forEach(item=>{
			item.addEventListener('click', ()=>{
				var copyText = item.querySelector('.txt-copy').innerHTML;
				copyToClipboard(copyText);
				alert("Успешно скопировано : " + copyText);
			})
		})
	}
}

document.querySelectorAll('.btn-ro').forEach(item=>{
	item.addEventListener('click',e=>{
		e.preventDefault()
	})
})

const popUps = () => {
	document.querySelectorAll('[data-btnPop]').forEach(item=>{
		item.addEventListener('click',e=>{
			e.preventDefault();
		})
	})
	let elem = document.querySelector('#popUp');
	document.querySelector('#popUp').addEventListener('click', e=>{
		if((e.target.classList.contains('popUp') && e.target.classList.contains('active'))){
			elem.classList.remove('active');
			document.body.classList.remove('stop-bady');
			elem.querySelectorAll('.popUp__block').forEach(item=>{
				item.classList.remove('active');
			});
		}
		if(e.target.closest('.popUp__exit') || e.target.dataset.closepopup){
			e.preventDefault();
			elem.classList.remove('active');
			document.body.classList.remove('stop-bady');
			e.target.closest('.popUp__block').classList.remove('active');
		}
	})
	const openPopUp = (elemBtn, blockPop) => {
		document.querySelectorAll(elemBtn).forEach(item=>{
			item.addEventListener('click',()=>{
				elem.querySelectorAll('.popUp__block').forEach(item=>{
					item.classList.remove('active');
				});
				elem.classList.add('active');
				document.body.classList.add('stop-bady');
				if(blockPop !== undefined)
				document.querySelector(blockPop).classList.add('active')
			})
		})
	}
	openPopUp("[data-btnPop='logInBtn']", "[data-idBlock='logInPop']");
	openPopUp("[data-btnPop='joinBtn']", "[data-idBlock='joinPop']");
	openPopUp("[data-btnPop='resetBtn']", "[data-idBlock='resetPassPop']");
	openPopUp("[data-btnPop='select2Pop']", "[data-idBlock='select2Pop']");
	openPopUp("[data-btnPop='gogAuth1Pop']", "[data-idBlock='gogAuth1Pop']");
	openPopUp("[data-btnPop='gogAuth2Pop']", "[data-idBlock='gogAuth2Pop']");
	openPopUp("[data-btnPop='gogAuth3Pop']", "[data-idBlock='gogAuth3Pop']");
	openPopUp("[data-btnPop='gogAuth4Pop']", "[data-idBlock='gogAuth4Pop']");


}

const aderClass = (elemBtn, elemItem) => {
	document.querySelectorAll(elemBtn).forEach(item=>{
		item.addEventListener('click', ()=>{
			document.querySelectorAll(elemItem).forEach(item=>{
				item.classList.toggle('active');
			});
		});
	});
};

const hovElemFun = (elemBtn, elemText) => {
	if(document.querySelector(elemBtn)){
		document.querySelectorAll(elemBtn).forEach(item=>{
			let elemHov = item.querySelector(elemText);
			item.addEventListener('mouseenter', ()=>{
				item.classList.add('active');
				if('animate' in elemHov){
					let getWidth = elemHov.offsetWidth;
					let animate = elemHov.animate([
						{ marginRight : '0px', marginLeft : '0px', display: 'block', width: '0px', opacity: 0 }, 
						{ marginRight : '12px', marginLeft : '12px',width: `${getWidth}px`, opacity: 1 }
					], 
						{ duration: 300 }
					);
				}
			})
			item.addEventListener('mouseleave', ()=>{
				if('animate' in elemHov){
					let getWidth = elemHov.offsetWidth;
					let animate = elemHov.animate([
						{ marginRight : '12px', marginLeft : '12px', width: `${getWidth}px`, opacity: 1} ,
						{ marginRight : '0px', marginLeft : '0px',width: '0px', opacity: 0 }
					], 
						{ duration: 300 }
					);

					animate.addEventListener('finish', function(){
						item.classList.remove('active');
					});
				}
			})
		});
	}
}

const calcer = () => {
	document.querySelectorAll('.inputBoxAm').forEach(item=>{
		item.addEventListener('click', e=>{
			let valueRow = item.querySelector('input');
			if(e.target.classList.contains('inputBoxAm__btn-minus')){
				e.preventDefault();
				if(valueRow.value == ''){
					item.querySelector('input').value = 0;
				}
				valueRow.value = parseInt(valueRow.value) - 1
			};
			if(e.target.classList.contains('inputBoxAm__btn-plus')){
				e.preventDefault();
				if(valueRow.value == ''){
					item.querySelector('input').value = 0;
				}
				valueRow.value = parseInt(valueRow.value) + 1
			};
		})
	})
}

const tableActStar = () => {
	document.querySelectorAll('[data-fave="fave-act"]').forEach(item=>{
		item.addEventListener('click', e=>{
			e.preventDefault();
			item.classList.toggle('active');
		})
	})
}

const init = () => {
	clickBel('#langBtn', "#langList", 'option__opt-btn');
	clickBel('#valBtn', "#valList", 'option__opt-btn');
	clickBel('#nav-btsaw', "#navAtc", 'option__opt-btn');
	header();
	sliers();
	calcer();
	accordion('#faq__atr-list','.faq__atr-item','.faq__atr-btn');
	selecter();
	tabs('.vars__tabs','btn-ro','.vars__block-item', true, "#tab-rowt");
	tabs('.vars__tabraw','vars__nav-btn','.vars__block-item');
	tabs('.policy__row','policy__btn','.policy__text');
	tabs('.popUp__tabs-wrap','popUp__tab-btn','.popUp__tab');
	passHide();
	popUps();
	copyText();
	copyForew('#btn-copy1','#cop-link1');
	copyForew('#btn-copy2','#cop-link2');
	copyForew('#btn-copy3','#cop-link3');
	copyForew('.popUp__addredst-copy','.popUp__addredst-addr');
	aderClass("#btnPopQR", "#elemPopQR");
	hovElemFun('.hovElemFun', '.hovElemFun__text');
	tableActStar();
};


window.addEventListener('DOMContentLoaded', init)